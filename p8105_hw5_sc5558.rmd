---
title: "p8105_hw5_sc5558"
author: "Shiyun Angel Cheng"
date: "2025-11-14"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(collapse = TRUE, message = FALSE)
```

Load Necessary Libraries 
```{r}
library(tidyverse)
```


## Problem 1

Suppose you put ùëõpeople in a room, and want to know the probability that at least two people share a birthday. For simplicity, we‚Äôll assume there are no leap years (i.e. there are only 365 days) and that birthdays are uniformly distributed over the year (which is actually not the case).

Write a function that, for a fixed group size, randomly draws ‚Äúbirthdays‚Äù for each person; checks whether there are duplicate birthdays in the group; and returns TRUE or FALSE based on the result.
```{r}
shared_birthday <- function(n) {
  # Randomly assign each person a birthday from 1‚Äì365 (with replacement)
  birthdays = sample(1:365, size = n, replace = TRUE)
  # Check if any birthday appears more than once; TRUE = shared birthday exists
  any(duplicated(birthdays))
}
```
Next, run this function 10000 times for each group size between 2 and 50. For each group size, compute the probability that at least two people in the group will share a birthday by averaging across the 10000 simulation runs. 
```{r}
set.seed(123)

birthday_sim =
  tibble(group_size = 2:50) |> 
  mutate(
    sims = map(group_size, ~ replicate(10000, shared_birthday(.x))),
    prob_shared = map_dbl(sims, mean)
  )
```
Make a plot showing the probability as a function of group size, and comment on your results.
```{r}
birthday_sim |>
  ggplot(aes(x = group_size, y = prob_shared)) +
  # shows trend
  geom_line() +
  # shows individual estimates
  geom_point() +
  labs(
    title = "Probability of Shared Birthday by Group Size",
    x = "Group Size",
    y = "Probability"
  )
```
Comment on plot: The curve shows how probability increases with group size. Aroudn group size 23, the probability exceeds 0.5, which is consistent with the classic birthday paradox. Until group 50, the probability is close to 1. 

## Problem 2



## Problem 3


```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.